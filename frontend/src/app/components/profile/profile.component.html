<div *ngIf="loading" style="text-align: center; padding: 40px;">
  <mat-spinner></mat-spinner>
</div>

<div *ngIf="!loading">
  <h1>Your Profile</h1>
  <p>Manage your personal information and fitness goals</p>

  <mat-card>
    <mat-card-header>
      <mat-card-title>Personal Information</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="profileForm">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Name</mat-label>
          <input matInput formControlName="name" required>
          <mat-error *ngIf="profileForm.get('name')?.hasError('required')">
            Name is required
          </mat-error>
        </mat-form-field>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
          <mat-form-field appearance="outline">
            <mat-label>Age</mat-label>
            <input matInput type="number" formControlName="age">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Gender</mat-label>
            <mat-select formControlName="gender">
              <mat-option *ngFor="let gender of genders" [value]="gender.value">
                {{ gender.label }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
          <mat-form-field appearance="outline">
            <mat-label>Height (cm)</mat-label>
            <input matInput type="number" formControlName="height">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Weight (kg)</mat-label>
            <input matInput type="number" formControlName="weight">
          </mat-form-field>
        </div>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Fitness Goal</mat-label>
          <mat-select formControlName="goal" required>
            <mat-option *ngFor="let goal of goals" [value]="goal.value">
              {{ goal.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button mat-raised-button color="accent" (click)="regeneratePlans()" [disabled]="regenerating">
            {{ regenerating ? 'Regenerating...' : 'Regenerate Plans' }}
          </button>
          <button mat-raised-button color="primary" (click)="saveProfile()" [disabled]="saving || profileForm.invalid">
            {{ saving ? 'Saving...' : 'Save Changes' }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>

